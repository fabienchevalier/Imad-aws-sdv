#CI qui teste le backend situ√© dans la branche master

name: TestAndDeploy

on: [push]

jobs:
  build_test:
    runs-on: ubuntu-latest

    steps:
    - name: Checkout master
      uses: actions/checkout@v3
      with:
        ref: 'master'
   
    - name: Set up Python 3.9
      uses: actions/setup-python@v2
      with:
        python-version: 3.9
    
    - name: Install dependencies to be able to test
      run: python -m pip install --upgrade pip && pip install unittest requests
        
    - name: Build docker-compose
      run: docker-compose -d
    
    - name: Run test
      run: python uni_test.py

  # deploy_to_pprd:
  #   needs: build_test
  #   runs-on: ubuntu-latest

  #   steps:
  #     - name: Checkout master
  #       uses: actions/checkout@v3
  #       with:
  #         ref: 'master'
      
  #     - name: Push to dev
  #       uses: s0/git-publish-subdir-action@develop
  #       env:
  #         REPO: self
  #         BRANCH: dev # The branch name where you want to push the assets
  #         FOLDER: backend-Python # The directory where your assets are generated
  #         GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }} # GitHub will automatically add this - you don't need to bother getting a token
  #         MESSAGE: "Build: ({sha}) {msg} passed the tests with success" # The commit message
        
      



